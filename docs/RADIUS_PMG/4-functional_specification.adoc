= Functional Specification

== Product Contents, Structure

The major parts of RPMG are:

* _ATTR.awk_ script: This is the most important part of the product.

* A pair of encoder and decoder functions to invoke RAW encoder/decoder.

* __RADIUS_Mapping.ttcn__ module: provide the authentication.

The RADIUS Base Protocol <<11-references.adoc#_1, [1]>> and other RADIUS applications are specified in RDFs developed by TCC as part of the RPMG product.

The TTCN-3 module (`RADIUS_Types`) that is generated by the script varies between applications, thus it is NOT a product.

[[encoding-decoding-and-other-related-functions]]
== Encoding/Decoding and Other Related Functions

This product also contains encoding/decoding functions that assure correct encoding of messages when sent from Titan and correct decoding of messages when received by Titan. Implemented encoding/decoding functions:

[cols=3*,options=header]
|===

|Name
|Type of formal parameters
|Type of return value

|`f_RADIUS_Enc`
|(in PDU_RADIUS pdu)
|octetstring;

|`f_RADIUS_Dec`
|(in octetstring stream)
|PDU_RADIUS;
|===

Two separate external functions are available for encrypting the password and calculating the Authenticator:

[cols=3*,options=header]
|===

|Name
|Type of formal parameters
|Type of return value

|`f_crypt_password`
|(in octetstring P, octetstring; in octetstring req_auth, in octetstring salt, in boolean decrypt, in charstring secret)
|octetstring

|`f_calc_MD5`
|(in octetstring input)
|octetstring;

|`f_crypt_s_key`
|(in octetstring pl_s_key, octetstring in octetstring pl_req_auth in charstring secret in boolean decrypt)
|octetstring

|`f_crypt_tunnel_password`
|(in octetstring pl_password octetstring in octetstring req_auth in octetstring salt in charstring secret in Boolean decrypt)
|octetstring
|===

Other functions are available in `PPP_CNL113599` Protocol Module to encode and decode EAP Messages which can be encapsulated in EAP-Message Attribute (Type: 79)

== Protocol Version Implemented

Currently the following applications are supported:

[width="100%",cols="85%,15%",options="header",]
|=====================================================
|RDFs |Refs.
|__BaseTypes_IETF_RFC2865.rdf__ |<<11-references.adoc#_1, [1]>>
|__Accounting_IETF_RFC2866_RFC2867.rdf__ |<<11-references.adoc#_5, [5]>>, <<11-references.adoc#_12, [12]>>
|__TunnelAuthentication_IETF_RFC2868.rdf__ |<<11-references.adoc#_6, [6]>>
|__Extensions_IETF_RFC2869.rdf__ |<<11-references.adoc#_7, [7]>>
|__IPv6_IETF_RFC3162.rdf__ |<<11-references.adoc#_8, [8]>>
|__DynamicAuthorizationExtensions_IETF_RFC5176.rdf__ |<<11-references.adoc#_9, [9]>>
|__ChargeableUserIdentity_IETF_RFC4372.rdf__ |<<11-references.adoc#_10, [10]>>
|__GGSN_FS_46_15517_CSA113_4RevB.rdf__ |<<11-references.adoc#_11, [11]>>
|=====================================================

[width="100%",cols="85%,15%",options="header",]
|===============================
|Vendor specific RDFs |Refs.
|_Cisco.rdf_ |
|_Juniper.rdf_ |
|_Scap.rdf_ |
|_Smartedge.rdf_ |<<11-references.adoc#_13, [13]>>
|_Vendor.rdf_ |
|_skt.rdf_ |
|__Vendor_detailed_ericsson.rdf__ |
|===============================

[width="100%",cols="85%,15%",options="header",]
|=======================================
|RDFs (in obsolate) |Refs.
|__RadiusBaseTypes.rdf__ |<<11-references.adoc#_1, [1]>>
|__RadiusAccountingAttributes.rdf__ |<<11-references.adoc#_5, [5]>>
|__TunnelAuthenticationAttributes.rdf__ |<<11-references.adoc#_6, [6]>>
|__RadiusExtensions.rdf__ |<<11-references.adoc#_7, [7]>>
|__RadiusAndIPv6.rdf__ |<<11-references.adoc#_8, [8]>>
|__RadiusAuthExtensions.rdf__ |<<11-references.adoc#_9, [9]>>
|__RadiusGGSN.rdf__ |<<11-references.adoc#_11, [11]>>
|=======================================
